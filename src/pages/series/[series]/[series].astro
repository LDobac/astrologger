---
import { slug as slugger } from "github-slugger";
import { getCollection, type CollectionEntry } from "astro:content";
import Layout from "../../../layouts/Layout.astro";
import GetSeriesList from "../../../utils/GetSeriesList";
import PostList from "../../../components/PostList.astro";

export async function getStaticPaths () {
    const seriesList = await GetSeriesList();
    const posts = await getCollection("posts");
    
    return seriesList.map((series) => {
        return {
            params: { series: slugger(series) },
            props: {
                series: series,
                posts: posts.filter(post => post.data.series ? post.data.series === series : false) 
            }
        }
    });
}

interface Props {
    posts: Array<CollectionEntry<"posts">>
    series: string
}

const { posts, series } = Astro.props;
---

<Layout title="Series List">
    <p class="flex flex-col text-center mb-6 border-b-2 pb-4">
        <span>Series</span>
        <span class="font-bold text-2xl text-sky-300">{series}</span>
    </p>

    <PostList posts={posts} />
</Layout>
